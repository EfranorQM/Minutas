(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{be8c:function(t,e,a){},e23d:function(t,e,a){"use strict";var o=a("be8c"),n=a.n(o);n.a},f291:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md q-gutter-sm bg-grey-2 background-height relative-position"},[a("q-breadcrumbs",[a("q-breadcrumbs-el",{attrs:{label:"Ascensos",icon:"person",to:t.ROUTES.personal.promotions}}),a("q-breadcrumbs-el",{attrs:{label:t.action.created?"Crear":"Modificar",icon:t.action.created?"attach_file":"edit"}})],1),t.loadingState?a("div",[a("q-spinner-tail",{staticClass:"absolute-center text-default",attrs:{size:"5em"}})],1):t.withEmployees&&t.withRanks?a("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},[a("q-expansion-item",{attrs:{"expand-separator":"",icon:"account_circle",label:"Datos","default-opened":!0,caption:t.action.created?null:t.promotionData.codeMinutes}},[a("q-card",[a("q-card-section",[a("q-form",{on:{submit:t.onSubmit}},[a("div",{staticClass:"row q-mb-xs text-bold"},[t._v("\n              Información principal:\n            ")]),a("q-toggle",{staticClass:"q-mb-sm",attrs:{color:"primary",label:"Activo"},model:{value:t.promotionData.active,callback:function(e){t.$set(t.promotionData,"active",e)},expression:"promotionData.active"}}),a("div",{staticClass:"row"},[t.promotionData.active?t._e():a("q-input",{staticClass:"ControlForm col-3 q-mr-md",attrs:{filled:"",label:"Fecha desactivación","stack-label":"",readonly:"",rules:[]},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{mask:"DD/MM/YYYY",options:t.maxDateIsToday},on:{input:function(){return t.$refs.qDateProxy.hide()}},model:{value:t.promotionData.dateDeactivation,callback:function(e){t.$set(t.promotionData,"dateDeactivation",e)},expression:"promotionData.dateDeactivation"}})],1)],1)]},proxy:!0}],null,!1,4160574148),model:{value:t.promotionData.dateDeactivation,callback:function(e){t.$set(t.promotionData,"dateDeactivation",e)},expression:"promotionData.dateDeactivation"}})],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"ControlForm col-3 q-mr-md",attrs:{filled:"",label:"Codigo Acta","stack-label":"","lazy-rules":"",rules:[function(t){return t&&t.length>0||"Por favor ingresa un codigo"},function(t){return t&&t.length<=40||"Longitud maxima de 40 carácteres"}]},model:{value:t.promotionData.codeMinutes,callback:function(e){t.$set(t.promotionData,"codeMinutes",e)},expression:"promotionData.codeMinutes"}}),a("q-input",{staticClass:"ControlForm col-2 q-mr-md",attrs:{filled:"",label:"Fecha Acta","stack-label":"",readonly:"",rules:[function(t){return t&&t.length>0||"Por favor ingresa una fecha"}]},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{mask:"DD/MM/YYYY",options:t.maxDateIsToday},on:{input:function(){return t.$refs.qDateProxy.hide()}},model:{value:t.promotionData.dateMinutes,callback:function(e){t.$set(t.promotionData,"dateMinutes",e)},expression:"promotionData.dateMinutes"}})],1)],1)]},proxy:!0}]),model:{value:t.promotionData.dateMinutes,callback:function(e){t.$set(t.promotionData,"dateMinutes",e)},expression:"promotionData.dateMinutes"}}),a("q-input",{staticClass:"ControlForm col-3 q-mr-md",attrs:{filled:"",label:"Codigo Resolución","stack-label":"","lazy-rules":"",rules:[function(t){return t&&t.length>0||"Por favor ingresa un codigo"},function(t){return t&&t.length<=40||"Longitud maxima de 40 carácteres"}]},model:{value:t.promotionData.codeResolution,callback:function(e){t.$set(t.promotionData,"codeResolution",e)},expression:"promotionData.codeResolution"}}),a("q-input",{staticClass:"ControlForm col",attrs:{filled:"",label:"Fecha Resolución","stack-label":"",readonly:"",rules:[function(t){return t&&t.length>0||"Por favor ingresa una fecha"}]},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{mask:"DD/MM/YYYY",options:t.maxDateIsToday},on:{input:function(){return t.$refs.qDateProxy.hide()}},model:{value:t.promotionData.dateResolution,callback:function(e){t.$set(t.promotionData,"dateResolution",e)},expression:"promotionData.dateResolution"}})],1)],1)]},proxy:!0}]),model:{value:t.promotionData.dateResolution,callback:function(e){t.$set(t.promotionData,"dateResolution",e)},expression:"promotionData.dateResolution"}})],1),a("div",{staticClass:"row"},[a("q-select",{staticClass:"ControlForm col q-mr-md",attrs:{filled:"",label:"Empleado",options:t.employees,"option-value":"id","option-label":function(t){return null===t?"":t.person+" - "+t.position},"stack-label":"","lazy-rules":"",rules:[]},model:{value:t.promotionData.employee,callback:function(e){t.$set(t.promotionData,"employee",e)},expression:"promotionData.employee"}}),a("q-select",{staticClass:"ControlForm col",attrs:{filled:"",label:"Rango",options:t.ranks,"option-value":"id","option-label":"name","stack-label":"","lazy-rules":"",rules:[]},model:{value:t.promotionData.rank,callback:function(e){t.$set(t.promotionData,"rank",e)},expression:"promotionData.rank"}})],1),a("div",{staticClass:"row q-mb-xs text-bold"},[t._v("\n              Información adicional:\n            ")]),a("div",{staticClass:"row"},[a("q-input",{staticClass:"ControlForm col q-mr-md",attrs:{filled:"",autogrow:"",label:"Descripción","stack-label":"","lazy-rules":"",rules:[]},model:{value:t.promotionData.description,callback:function(e){t.$set(t.promotionData,"description",e)},expression:"promotionData.description"}}),a("div",{staticClass:"col-5"},[!t.action.created&&t.promotionData.pathFile?a("div",{staticClass:"q-mb-md"},[a("div",{staticClass:"row q-mb-xs"},[t._v("\n                    Descargar archivo actual:\n                  ")]),a("a",{attrs:{href:t.NATIVE_URL+"/files/ascensos/"+t.promotionData.pathFile}},[a("q-btn",{staticClass:"full-width",attrs:{color:"positive","icon-right":"cloud_download",align:"between"}},[a("div",{staticClass:"ellipsis"},[t._v("\n                        "+t._s(t.promotionData.pathFile.substr(12))+"\n                      ")])])],1)]):t._e(),t.promotionData.pathFile?t._e():a("div",{staticClass:"row q-mb-xs"},[t._v("\n                  Subir archivo de soporte:\n                ")]),t.promotionData.pathFile?a("div",{staticClass:"row q-mb-xs"},[t._v("\n                  Cambiar archivo de soporte:\n                ")]):t._e(),a("div",{staticClass:"row q-mb-md"},[a("q-uploader",{staticClass:"col",attrs:{"hide-upload-btn":"",accept:".pdf, .dot, .doc, .docx, .odt, .xls,\n                      .xlsx, .ods, .ppt, .pptx, image/*"},on:{added:t.handleFileUpload}})],1)])],1),a("q-btn",{staticClass:"full-width",attrs:{label:t.action.created?"GUARDAR":"ACTUALIZAR DATOS",loading:t.loading,type:"submit",color:"positive"}})],1)],1)],1)],1)],1):t.withEmployees?t.withRanks?t._e():a("div",{staticClass:"text-center"},[a("div",{staticClass:"empty-state normal-section empty-ranks"}),a("h4",{staticClass:"empty-copy"},[t._v(" No hay rangos disponibles ")]),"supervisor"===t.user.type||"personal"!==t.user.type&&"administrador-general"!==t.user.type?t._e():a("q-btn",{staticClass:"text-capitalize",staticStyle:{height:"min-content"},attrs:{color:"positive",label:"LISTAR RANGOS",to:t.ROUTES.personal.ranks}})],1):a("div",{staticClass:"text-center"},[a("div",{staticClass:"empty-state normal-section empty-curriculums"}),a("h4",{staticClass:"empty-copy"},[t._v(" No hay empleados disponibles ")]),"supervisor"===t.user.type||"personal"!==t.user.type&&"administrador-general"!==t.user.type?t._e():a("q-btn",{staticClass:"text-capitalize",staticStyle:{height:"min-content"},attrs:{color:"positive",label:"LISTAR EMPLEADOS",to:t.ROUTES.personal.curriculum}})],1)],1)},n=[],i=(a("456d"),a("8a81"),a("d25f"),a("9986"),a("8e6e"),a("9523")),s=a.n(i),r=a("c973"),l=a.n(r),c=a("a34a"),p=a.n(c),u=(a("a481"),a("5df3"),a("06db"),a("cadf"),a("ac6a"),a("551c"),a("7514"),a("bd4c")),d=a("e71c"),m=a("234a"),f=a("377a"),b=a("2fa3");function D(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function v(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?D(Object(a),!0).forEach((function(e){s()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var h=u["b"].formatDate,y=Date.now(),x={name:"AlterPromotions",mixins:[m["a"]],data:function(){return{loadingState:!0,promotionData:{dateMinutes:h(y,"DD/MM/YYYY"),dateResolution:h(y,"DD/MM/YYYY"),codeMinutes:null,codeResolution:null,description:null,active:!0,dateDeactivation:h(y,"DD/MM/YYYY"),employee:null,rank:null,pathFile:null,file:null},loading:!1,today:y,ROUTES:d["p"],withEmployees:!0,withRanks:!0,employees:[],ranks:[],NATIVE_URL:d["o"]}},methods:{onSubmit:function(){var t=this;return l()(p.a.mark((function e(){var a,o,n,i,s,r;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.loading=!0,!t.action.created){e.next=21;break}return e.prev=2,e.next=5,f["a"].getApiFormat(t.promotionData);case 5:return a=e.sent,e.next=8,t.$store.dispatch("promotions/store",a);case 8:o="Registro exitoso",t.createNotification(v({message:o,timeout:3e3},d["q"])),t.loading=!1,t.$router.replace(d["p"].personal.promotions),e.next=19;break;case 14:e.prev=14,e.t0=e["catch"](2),n=Object(b["d"])(e.t0),t.createNotification(v({message:n,timeout:5e3},d["b"])),t.loading=!1;case 19:e.next=38;break;case 21:return e.prev=21,e.next=24,f["a"].getApiFormat(t.promotionData);case 24:return i=e.sent,e.next=27,t.$store.dispatch("promotions/update",i);case 27:s="Actualizacion satisfactoria",t.createNotification(v({message:s,timeout:3e3},d["q"])),t.loading=!1,t.$router.replace(d["p"].personal.promotions),e.next=38;break;case 33:e.prev=33,e.t1=e["catch"](21),r=Object(b["d"])(e.t1),t.createNotification(v({message:r,timeout:5e3},d["b"])),t.loading=!1;case 38:case"end":return e.stop()}}),e,null,[[2,14],[21,33]])})))()},maxDateIsToday:function(t){return t<=h(y,"YYYY/MM/DD")},minDateIsToday:function(t){return t>=h(y,"YYYY/MM/DD")},handleFileUpload:function(t){var e=t[0];this.promotionData.file=e}},computed:{user:function(){return this.$q.localStorage.getItem(d["n"])},action:function(){return this.$q.localStorage.getItem(d["j"])}},created:function(){var t=this;return l()(p.a.mark((function e(){var a,o;return p.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=Promise,e.next=3,t.$store.dispatch("employees/get");case 3:return e.t1=t.employees=e.sent,e.next=6,t.$store.dispatch("ranks/get");case 6:return e.t2=t.ranks=e.sent,e.t3=[e.t1,e.t2],e.next=10,e.t0.all.call(e.t0,e.t3);case 10:if(t.withEmployees=t.employees.length>0,t.withRanks=t.ranks.length>0,!t.withEmployees||!t.withRanks){e.next=24;break}if(!t.action.created){e.next=18;break}t.promotionData.rank=t.ranks?t.ranks[0]:{},t.promotionData.employee=t.employees?t.employees[0]:{},e.next=24;break;case 18:return a=t.action.id,e.next=21,t.$store.dispatch("promotions/getForId",a);case 21:o=e.sent,t.promotionData=o,t.promotionData.dateDeactivation=o.dateDeactivation?o.dateDeactivation:h(y,"DD/MM/YYYY");case 24:t.loadingState=!1;case 25:case"end":return e.stop()}}),e)})))()},beforeRouteEnter:function(t,e,a){a((function(e){if(e.user){var o=Object(d["v"])(e.user.type),n=o.find((function(e){return e===t.path}));n||a(o[0]),a()}else a("/")}))}},g=x,k=(a("e23d"),a("2877")),q=Object(k["a"])(g,o,n,!1,null,null,null);e["default"]=q.exports}}]);