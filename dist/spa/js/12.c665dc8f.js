(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"066f":function(e,t,a){"use strict";var o=a("a062"),n=a.n(o);n.a},a062:function(e,t,a){},ca96:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"q-pa-md q-gutter-sm bg-grey-2 background-height relative-position"},[o("q-breadcrumbs",[o("q-breadcrumbs-el",{attrs:{label:"Personas",icon:"person",to:e.ROUTES.personal.persons}}),o("q-breadcrumbs-el",{attrs:{label:e.action.created?"Crear":"Modificar",icon:e.action.created?"attach_file":"edit"}})],1),e.loadingState?o("div",[o("q-spinner-tail",{staticClass:"absolute-center text-default",attrs:{size:"5em"}})],1):o("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},[o("q-expansion-item",{attrs:{"expand-separator":"",icon:"account_circle",label:"Datos","default-opened":!0,caption:e.action.created?null:e.personData.name}},[o("q-card",[o("q-card-section",[o("q-form",{on:{submit:e.onSubmit}},[o("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.onFilePicked}}),o("div",{staticClass:"row q-mb-xs"},[o("span",{staticClass:"text-bold"},[e._v("Foto de perfil")]),o("span",{staticClass:"q-mx-xs"},[e._v("(Opcional)")]),o("span",{staticClass:"text-bold"},[e._v(":")])]),o("div",{staticClass:"text-center q-my-md"},[e.personData.photo?o("q-img",{staticClass:"image-profile",attrs:{src:e.personData.photo}},[o("div",{staticClass:"absolute-bottom text-subtitle1 text-center"},[o("q-btn",{staticClass:"full-width",attrs:{flat:"",color:"white",icon:"camera_alt"},on:{click:e.onPickFile}})],1)]):o("q-img",{staticClass:"image-profile",attrs:{src:a("874c")}},[o("div",{staticClass:"absolute-bottom text-subtitle1 text-center"},[o("q-btn",{staticClass:"full-width",attrs:{flat:"",color:"white",icon:"camera_alt"},on:{click:e.onPickFile}})],1)])],1),o("div",{staticClass:"row q-mb-xs text-bold"},[e._v("\n              Información principal:\n            ")]),o("q-toggle",{staticClass:"q-mb-sm",attrs:{color:"primary",label:"Vivo"},model:{value:e.personData.live,callback:function(t){e.$set(e.personData,"live",t)},expression:"personData.live"}}),o("div",{staticClass:"row"},[o("q-input",{staticClass:"ControlForm col-4 q-mr-md",attrs:{filled:"",label:"Nombre","stack-label":"","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Por favor ingresa el nombre"},function(e){return e&&e.length<=80||"Longitud maxima de 80 carácteres"}]},model:{value:e.personData.name,callback:function(t){e.$set(e.personData,"name",t)},expression:"personData.name"}}),o("q-input",{staticClass:"ControlForm col q-mr-md",attrs:{filled:"",label:"Tel. Fijo",type:"number",min:0,"stack-label":"","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Por favor ingresa un telefono"},function(e){return e&&e>0&&e.length<=10||"Numero invalido"}]},model:{value:e.personData.phone,callback:function(t){e.$set(e.personData,"phone",t)},expression:"personData.phone"}}),o("q-input",{staticClass:"ControlForm col-3 q-mr-md",attrs:{filled:"",label:"Documento",type:"number",min:0,"stack-label":"","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Por favor ingresa el documento"},function(e){return e&&e>0&&e.length<=10||"Documento invalido"}]},model:{value:e.personData.document,callback:function(t){e.$set(e.personData,"document",t)},expression:"personData.document"}}),o("q-input",{staticClass:"ControlForm col-2",attrs:{filled:"",label:"Nacimiento","stack-label":"",readonly:"",rules:[function(e){return e&&e.length>0||"Por favor ingresa una fecha"}]},scopedSlots:e._u([{key:"append",fn:function(){return[o("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[o("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[o("q-date",{attrs:{mask:"DD/MM/YYYY",options:e.maxDateIsToday},on:{input:function(){return e.$refs.qDateProxy.hide()}},model:{value:e.personData.birthDate,callback:function(t){e.$set(e.personData,"birthDate",t)},expression:"personData.birthDate"}})],1)],1)]},proxy:!0}]),model:{value:e.personData.birthDate,callback:function(t){e.$set(e.personData,"birthDate",t)},expression:"personData.birthDate"}})],1),o("div",{staticClass:"row"},[o("q-input",{staticClass:"ControlForm col-3 q-mr-md",attrs:{filled:"",label:"Correo","stack-label":"","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Por favor ingresa un correo electronico"}]},model:{value:e.personData.email,callback:function(t){e.$set(e.personData,"email",t)},expression:"personData.email"}}),o("q-select",{staticClass:"ControlForm col-2 q-mr-md",attrs:{filled:"",options:["Soltero(a)","Casado(a)","Divorciado(a)"],label:"Estado civil","stack-label":"","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Por favor selecciona un estado"}]},model:{value:e.personData.civilStatus,callback:function(t){e.$set(e.personData,"civilStatus",t)},expression:"personData.civilStatus"}}),o("q-input",{staticClass:"ControlForm col-2 q-mr-md",attrs:{filled:"",label:"Peso",suffix:"kgs",hint:"Ejemplo: 75 kgs","stack-label":"","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Por favor ingresa tu peso"},function(e){return e>40&&e<=120||"Peso invalido"}]},model:{value:e.personData.weight,callback:function(t){e.$set(e.personData,"weight",t)},expression:"personData.weight"}}),o("q-input",{staticClass:"ControlForm col q-mr-md",attrs:{filled:"",label:"Estatura",suffix:"mts",hint:"Ejemplo: 1.80 mts","stack-label":"","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Por favor ingresa tu estatura"},function(e){return e>1&&e<=2.5||"Estatura invalida"}]},model:{value:e.personData.height,callback:function(t){e.$set(e.personData,"height",t)},expression:"personData.height"}}),o("q-select",{staticClass:"ControlForm col-2",attrs:{filled:"",options:["Masculino","Femenino"],label:"Genero","stack-label":"","lazy-rules":"",rules:[]},model:{value:e.personData.sex,callback:function(t){e.$set(e.personData,"sex",t)},expression:"personData.sex"}})],1),o("div",{staticClass:"row"},[o("q-input",{staticClass:"ControlForm col q-mr-md",attrs:{filled:"",label:"Celular",type:"number",min:0,"stack-label":"","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Por favor ingresa un celular"},function(e){return e&&10===e.length||"Numero invalido"}]},model:{value:e.personData.mobile,callback:function(t){e.$set(e.personData,"mobile",t)},expression:"personData.mobile"}}),o("SelectionInput",{staticClass:"col-5 q-mr-md",attrs:{searchParent:e.personData.birthCity,optionsMenu:e.cities,optionValue:"id",optionLabel:"name",filled:!0,label:"Ciudad de Nacimiento",hint:e.personData.birthCity?"":"Escribe por lo menos dos letras, ten en cuenta las tildes.",rules:[function(){return e.personData.birthCity||"Por favor selecciona una ciudad"}]},model:{value:e.personData.birthCity,callback:function(t){e.$set(e.personData,"birthCity",t)},expression:"personData.birthCity"}}),o("q-select",{staticClass:"ControlForm col q-mr-md",attrs:{filled:"",label:"Tipo de sangre",options:e.bloodTypes,"option-value":"id","option-label":"name","stack-label":"","lazy-rules":"",rules:[]},model:{value:e.personData.bloodType,callback:function(t){e.$set(e.personData,"bloodType",t)},expression:"personData.bloodType"}}),o("q-select",{staticClass:"ControlForm col",attrs:{filled:"",label:"Profesión",options:e.professions,"option-value":"id","option-label":"name","stack-label":"","lazy-rules":"",rules:[]},model:{value:e.personData.profession,callback:function(t){e.$set(e.personData,"profession",t)},expression:"personData.profession"}})],1),o("div",{staticClass:"row q-mb-xs text-bold"},[e._v("\n              Información adicional:\n            ")]),o("div",{staticClass:"row"},[o("q-input",{staticClass:"ControlForm col q-mr-md",attrs:{filled:"",label:"Dirección","stack-label":"","lazy-rules":"",rules:[function(e){return!e||(e.length<=100||"Longitud maxima de 100 carácteres")}]},model:{value:e.personData.address,callback:function(t){e.$set(e.personData,"address",t)},expression:"personData.address"}}),o("q-input",{staticClass:"ControlForm col",attrs:{filled:"",label:"Barrio","stack-label":"","lazy-rules":"",rules:[function(e){return!e||(e.length<=50||"Longitud maxima de 50 carácteres")}]},model:{value:e.personData.neighborhood,callback:function(t){e.$set(e.personData,"neighborhood",t)},expression:"personData.neighborhood"}})],1),o("q-btn",{staticClass:"full-width",attrs:{label:e.action.created?"GUARDAR":"ACTUALIZAR DATOS",loading:e.loading,type:"submit",color:"positive"}})],1)],1)],1)],1)],1)],1)},n=[],s=(a("456d"),a("8a81"),a("d25f"),a("9986"),a("8e6e"),a("9523")),r=a.n(s),l=a("c973"),i=a.n(l),c=a("a34a"),u=a.n(c),p=(a("a481"),a("7f7f"),a("5df3"),a("06db"),a("cadf"),a("ac6a"),a("551c"),a("7514"),a("bd4c")),d=a("e71c"),m=a("0e14"),f=a("234a"),b=a("c26b"),D=a("2fa3");function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){r()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var v=p["b"].formatDate,x=p["b"].subtractFromDate,C=Date.now(),y={name:"AlterPersons",components:{SelectionInput:m["a"]},mixins:[f["a"]],data:function(){return{loadingState:!0,personData:{name:null,birthDate:v(x(C,{year:18}),"DD/MM/YYYY"),sex:"Masculino",live:!0,neighborhood:null,address:null,phone:null,mobile:null,civilStatus:"Soltero(a)",document:null,height:0,weight:0,email:null,photo:null,bloodType:null,birthCity:null,profession:null},loading:!1,today:C,ROUTES:d["p"],bloodTypes:[],cities:[],professions:[],image:null}},methods:{onSubmit:function(){var e=this;return i()(u.a.mark((function t(){var a,o,n,s,r,l,i;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.loading=!0,!e.action.created){t.next=21;break}return t.prev=2,t.next=5,b["a"].getApiFormat(e.personData);case 5:return a=t.sent,t.next=8,e.$store.dispatch("persons/store",a);case 8:o="Registro exitoso",e.createNotification(g({message:o,timeout:3e3},d["q"])),e.loading=!1,e.$router.replace(d["p"].personal.persons),t.next=19;break;case 14:t.prev=14,t.t0=t["catch"](2),n=Object(D["d"])(t.t0),e.createNotification(g({message:n,timeout:5e3},d["b"])),e.loading=!1;case 19:t.next=38;break;case 21:return t.prev=21,t.next=24,b["a"].getApiFormat(e.personData);case 24:return s=t.sent,t.next=27,e.$store.dispatch("persons/update",s);case 27:r="Actualizacion satisfactoria",e.createNotification(g({message:r,timeout:3e3},d["q"])),e.loading=!1,e.personData.id===e.user.id?(l=g({},e.user),l.name=e.personData.name,l.avatar=e.personData.photo?e.personData.photo:e.user.avatar,e.$q.localStorage.set(d["n"],l),e.$router.replace(d["p"].personal.persons),e.$router.go()):e.$router.replace(d["p"].personal.persons),t.next=38;break;case 33:t.prev=33,t.t1=t["catch"](21),i=Object(D["d"])(t.t1),e.createNotification(g({message:i,timeout:5e3},d["b"])),e.loading=!1;case 38:case"end":return t.stop()}}),t,null,[[2,14],[21,33]])})))()},maxDateIsToday:function(e){return e<=v(C,"YYYY/MM/DD")},minimumYears:function(e){return e<=v(x(C,{year:18}),"YYYY/MM/DD")},minDateIsToday:function(e){return e>=v(C,"YYYY/MM/DD")},onPickFile:function(){this.$refs.fileInput.click()},onFilePicked:function(e){var t=this,a=e.target.files,o=a[0].name;if(o.lastIndexOf(".")>0){var n=new FileReader;n.addEventListener("load",(function(){t.personData.photo=n.result})),n.readAsDataURL(a[0]),this.image=a?a[0]:null}}},computed:{user:function(){return this.$q.localStorage.getItem(d["n"])},action:function(){return this.$q.localStorage.getItem(d["i"])}},created:function(){var e=this;return i()(u.a.mark((function t(){var a,o;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=Promise,t.next=3,e.$store.dispatch("ui/getBloodTypes");case 3:return t.t1=e.bloodTypes=t.sent,t.next=6,e.$store.dispatch("ui/getCities");case 6:return t.t2=e.cities=t.sent,t.next=9,e.$store.dispatch("ui/getProfessions");case 9:return t.t3=e.professions=t.sent,t.t4=[t.t1,t.t2,t.t3],t.next=13,t.t0.all.call(t.t0,t.t4);case 13:if(!e.action.created){t.next=18;break}e.personData.bloodType=e.bloodTypes?e.bloodTypes[0]:{},e.personData.profession=e.professions?e.professions[0]:{},t.next=23;break;case 18:return a=e.action.id,t.next=21,e.$store.dispatch("persons/getForId",a);case 21:o=t.sent,e.personData=o;case 23:e.loadingState=!1;case 24:case"end":return t.stop()}}),t)})))()},beforeRouteEnter:function(e,t,a){a((function(t){if(t.user){var o=Object(d["v"])(t.user.type),n=o.find((function(t){return t===e.path}));n||a(o[0]),a()}else a("/")}))}},q=y,k=(a("066f"),a("2877")),w=Object(k["a"])(q,o,n,!1,null,null,null);t["default"]=w.exports}}]);