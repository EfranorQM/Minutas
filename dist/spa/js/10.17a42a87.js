(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{2045:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"q-pa-md q-gutter-sm bg-grey-2 background-height relative-position"},[a("q-breadcrumbs",[a("q-breadcrumbs-el",{attrs:{label:"Extintores",icon:"fireplace",to:e.ROUTES.extinguishers.extinguishers}}),a("q-breadcrumbs-el",{attrs:{label:e.action.created?"Crear":"Modificar",icon:e.action.created?"attach_file":"edit"}})],1),e.loadingState?a("div",[a("q-spinner-tail",{staticClass:"absolute-center text-default",attrs:{size:"5em"}})],1):e.withCustomers&&e.withExtinguisherTypes&&e.withCompanies?a("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},[a("q-expansion-item",{attrs:{"expand-separator":"",icon:"account_circle",label:"Datos","default-opened":!0,caption:e.action.created?null:e.extinguisherData.date}},[a("q-card",[a("q-card-section",[a("q-form",{on:{submit:e.onSubmit}},[a("div",{staticClass:"row q-mb-xs text-bold"},[e._v("\n              Información principal:\n            ")]),a("div",{staticClass:"row"},[a("q-input",{staticClass:"ControlForm col q-mr-md",attrs:{filled:"",label:"Fecha","stack-label":"",readonly:"",rules:[function(e){return e&&e.length>0||"Por favor ingresa una fecha"}]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{mask:"DD/MM/YYYY",options:e.maxDateIsToday},on:{input:function(){return e.$refs.qDateProxy.hide()}},model:{value:e.extinguisherData.date,callback:function(t){e.$set(e.extinguisherData,"date",t)},expression:"extinguisherData.date"}})],1)],1)]},proxy:!0}]),model:{value:e.extinguisherData.date,callback:function(t){e.$set(e.extinguisherData,"date",t)},expression:"extinguisherData.date"}}),a("q-input",{staticClass:"ControlForm col-3 q-mr-md",attrs:{filled:"",label:"Capacidad",mask:"# lb","fill-mask":"0","reverse-fill-mask":"",min:0,"stack-label":"","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Por favor ingresa una capacidad"},function(e){return e&&e.length<=20||"Longitud maxima de 20 carácteres"}]},model:{value:e.extinguisherData.capacity,callback:function(t){e.$set(e.extinguisherData,"capacity",t)},expression:"extinguisherData.capacity"}}),a("q-field",{staticClass:"ControlForm col",attrs:{label:"Tarifa",filled:"","stack-label":"","lazy-rules":"",rules:[]}},[a("money",{staticClass:"inputMoney",attrs:{precision:0,type:"text",maxLength:"14",prefix:"$ ",suffix:" COP"},model:{value:e.extinguisherData.rate,callback:function(t){e.$set(e.extinguisherData,"rate",t)},expression:"extinguisherData.rate"}})],1)],1),a("div",{staticClass:"row"},[a("q-select",{staticClass:"ControlForm col q-mr-md",attrs:{filled:"",label:"Cliente",options:e.customers,"option-value":"id","option-label":"name","stack-label":"","lazy-rules":"",rules:[]},model:{value:e.extinguisherData.customer,callback:function(t){e.$set(e.extinguisherData,"customer",t)},expression:"extinguisherData.customer"}}),a("q-select",{staticClass:"ControlForm col q-mr-md",attrs:{filled:"",label:"Tipo de extintor",options:e.extinguisherTypes,"option-value":"id","option-label":"name","stack-label":"","lazy-rules":"",rules:[]},model:{value:e.extinguisherData.extinguisherType,callback:function(t){e.$set(e.extinguisherData,"extinguisherType",t)},expression:"extinguisherData.extinguisherType"}}),a("q-select",{staticClass:"ControlForm col",attrs:{filled:"",label:"Empresa",options:e.companies,"option-value":"id","option-label":"name","stack-label":"","lazy-rules":"",rules:[]},model:{value:e.extinguisherData.company,callback:function(t){e.$set(e.extinguisherData,"company",t)},expression:"extinguisherData.company"}})],1),a("div",{staticClass:"row q-mb-xs text-bold"},[e._v("\n              Información adicional:\n            ")]),a("div",{staticClass:"row"},[a("q-input",{staticClass:"ControlForm col-6",attrs:{filled:"",autogrow:"",label:"Nota de servicio","stack-label":"","lazy-rules":"",rules:[]},model:{value:e.extinguisherData.serviceNote,callback:function(t){e.$set(e.extinguisherData,"serviceNote",t)},expression:"extinguisherData.serviceNote"}})],1),a("q-btn",{staticClass:"full-width",attrs:{label:e.action.created?"GUARDAR":"ACTUALIZAR DATOS",loading:e.loading,type:"submit",color:"positive"}})],1)],1)],1)],1)],1):e.withCustomers?e.withExtinguisherTypes?e.withCompanies?e._e():a("div",{staticClass:"text-center"},[a("div",{staticClass:"empty-state normal-section empty-companies"}),a("h4",{staticClass:"empty-copy"},[e._v(" No hay empresas disponibles ")]),"supervisor"===e.user.type||"prevencion-y-seguridad"!==e.user.type&&"administrador-general"!==e.user.type?e._e():a("q-btn",{staticClass:"text-capitalize",staticStyle:{height:"min-content"},attrs:{color:"positive",label:"LISTAR EMPRESAS",to:e.ROUTES.preventionAndSecurity.companies}})],1):a("div",{staticClass:"text-center"},[a("div",{staticClass:"empty-state normal-section empty-extinguisherTypes"}),a("h4",{staticClass:"empty-copy"},[e._v(" No hay tipos de extintores disponibles ")]),"supervisor"===e.user.type||"extintores"!==e.user.type&&"administrador-general"!==e.user.type?e._e():a("q-btn",{staticClass:"text-capitalize",staticStyle:{height:"min-content"},attrs:{color:"positive",label:"LISTAR TIPOS DE EXTINTORES",to:e.ROUTES.extinguishers.extinguisherTypes}})],1):a("div",{staticClass:"text-center"},[a("div",{staticClass:"empty-state normal-section empty-customers"}),a("h4",{staticClass:"empty-copy"},[e._v(" No hay clientes disponibles ")]),"supervisor"===e.user.type||"extintores"!==e.user.type&&"administrador-general"!==e.user.type?e._e():a("q-btn",{staticClass:"text-capitalize",staticStyle:{height:"min-content"},attrs:{color:"positive",label:"LISTAR CLIENTES",to:e.ROUTES.extinguishers.customers}})],1)],1)},i=[],r=(a("456d"),a("8a81"),a("d25f"),a("9986"),a("8e6e"),a("9523")),n=a.n(r),o=a("c973"),c=a.n(o),l=a("a34a"),u=a.n(l),p=(a("a481"),a("5df3"),a("06db"),a("cadf"),a("ac6a"),a("551c"),a("7514"),a("bd4c")),d=a("716b"),m=a("e71c"),h=a("234a"),x=a("3686"),g=a("2fa3");function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){n()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y=p["b"].formatDate,v=Date.now(),D={name:"AlterExtinguishers",mixins:[h["a"]],components:{Money:d["Money"]},data:function(){return{loadingState:!0,extinguisherData:{date:y(v,"DD/MM/YYYY"),capacity:null,rate:"",serviceNote:null,customer:null,extinguisherType:null,extinguisher:null},loading:!1,moneyFormatForDirective:{decimal:".",thousands:",",prefix:"$ ",suffix:" #",precision:2,masked:!1},today:v,ROUTES:m["p"],withCustomers:!0,withExtinguisherTypes:!0,withCompanies:!0,customers:[],extinguisherTypes:[],companies:[]}},methods:{onSubmit:function(){var e=this;return c()(u.a.mark((function t(){var a,s,i,r,n,o;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.loading=!0,!e.action.created){t.next=21;break}return t.prev=2,t.next=5,x["a"].getApiFormat(e.extinguisherData);case 5:return a=t.sent,t.next=8,e.$store.dispatch("extinguishers/store",a);case 8:s="Registro exitoso",e.createNotification(f({message:s,timeout:3e3},m["q"])),e.loading=!1,e.$router.replace(m["p"].extinguishers.extinguishers),t.next=19;break;case 14:t.prev=14,t.t0=t["catch"](2),i=Object(g["d"])(t.t0),e.createNotification(f({message:i,timeout:5e3},m["b"])),e.loading=!1;case 19:t.next=38;break;case 21:return t.prev=21,t.next=24,x["a"].getApiFormat(e.extinguisherData);case 24:return r=t.sent,t.next=27,e.$store.dispatch("extinguishers/update",r);case 27:n="Actualizacion satisfactoria",e.createNotification(f({message:n,timeout:3e3},m["q"])),e.loading=!1,e.$router.replace(m["p"].extinguishers.extinguishers),t.next=38;break;case 33:t.prev=33,t.t1=t["catch"](21),o=Object(g["d"])(t.t1),e.createNotification(f({message:o,timeout:5e3},m["b"])),e.loading=!1;case 38:case"end":return t.stop()}}),t,null,[[2,14],[21,33]])})))()},maxDateIsToday:function(e){return e<=y(v,"YYYY/MM/DD")},minDateIsToday:function(e){return e>=y(v,"YYYY/MM/DD")}},computed:{user:function(){return this.$q.localStorage.getItem(m["n"])},action:function(){return this.$q.localStorage.getItem(m["h"])}},created:function(){var e=this;return c()(u.a.mark((function t(){var a,s;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=Promise,t.next=3,e.$store.dispatch("customers/get");case 3:return t.t1=e.customers=t.sent,t.next=6,e.$store.dispatch("extinguisherTypes/get");case 6:return t.t2=e.extinguisherTypes=t.sent,t.next=9,e.$store.dispatch("companies/get");case 9:return t.t3=e.companies=t.sent,t.t4=[t.t1,t.t2,t.t3],t.next=13,t.t0.all.call(t.t0,t.t4);case 13:if(e.withCustomers=e.customers.length>0,e.withExtinguisherTypes=e.extinguisherTypes.length>0,e.withCompanies=e.companies.length>0,!(e.withCustomers&&e.withExtinguisherTypes&&e.withCompanies)){t.next=28;break}if(!e.action.created){t.next=23;break}e.extinguisherData.extinguisherType=e.extinguisherTypes?e.extinguisherTypes[0]:{},e.extinguisherData.customer=e.customers?e.customers[0]:{},e.extinguisherData.company=e.companies?e.companies[0]:{},t.next=28;break;case 23:return a=e.action.id,t.next=26,e.$store.dispatch("extinguishers/getForId",a);case 26:s=t.sent,e.extinguisherData=s;case 28:e.loadingState=!1;case 29:case"end":return t.stop()}}),t)})))()},beforeRouteEnter:function(e,t,a){a((function(t){if(t.user){var s=Object(m["v"])(t.user.type),i=s.find((function(t){return t===e.path}));i||a(s[0]),a()}else a("/")}))}},C=D,w=(a("4561"),a("2877")),T=Object(w["a"])(C,s,i,!1,null,null,null);t["default"]=T.exports},4561:function(e,t,a){"use strict";var s=a("681e"),i=a.n(s);i.a},"681e":function(e,t,a){}}]);