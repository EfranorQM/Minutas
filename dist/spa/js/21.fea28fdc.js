(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[21],{"0d11":function(e,t,a){},"570b":function(e,t,a){"use strict";var i=a("0d11"),n=a.n(i);n.a},"6aff":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"q-py-lg q-px-xl bg-grey-2 background-height"},[a("div",{staticClass:"row q-mb-xs"},[a("div",{staticClass:"title"},[e._v("CERTIFICADOS")]),"supervisor"!==e.user.type&&e.certificates&&e.certificates.length?a("InteractionOptions",{attrs:{selected:e.selected,createFunction:e.openCreateNew,editFunction:e.openUpdate,deleteFunction:e.openDelete}}):e._e()],1),a("q-separator"),e.loadingState?a("div",[a("q-spinner-tail",{staticClass:"absolute-center text-default",attrs:{size:"5em"}})],1):e.certificates&&e.certificates.length?a("TableView",{key:e.reRenderTable,attrs:{information:e.certificates,columns:e.columns,visibleColumns:e.visibleColumns},on:{selection:function(t){e.selected=t}}}):a("div",{staticClass:"text-center"},[a("div",{staticClass:"empty-state normal-section empty-certificates"}),a("h3",{staticClass:"empty-copy"},[e._v(" No hay registros aún.. ")]),"supervisor"!==e.user.type?a("q-btn",{staticClass:"text-capitalize",staticStyle:{height:"min-content"},attrs:{color:"positive",label:"PRIMER REGISTRO"},on:{click:e.openCreateNew}}):e._e()],1),a("q-dialog",{model:{value:e.alterCertificates,callback:function(t){e.alterCertificates=t},expression:"alterCertificates"}},[a("q-card",{staticStyle:{width:"500px","max-width":"80vw"}},[e.gettingInfo?a("q-spinner-tail",{staticClass:"absolute-center text-default",attrs:{size:"3em"}}):e._e(),a("q-card-section",[a("div",{staticClass:"text-h6 text-bold"},[e._v("Certificado")])]),a("q-card-section",[a("q-form",{on:{submit:e.alterRow,reset:e.reset}},[a("div",{staticClass:"row q-mb-xs text-bold"},[e._v("\n            Información principal:\n          ")]),a("div",{staticClass:"row"},[a("q-field",{staticClass:"ControlForm col q-mr-md",attrs:{label:"Tarifa",filled:"","stack-label":"","lazy-rules":"",rules:[]}},[a("money",{staticClass:"inputMoney",attrs:{precision:0,type:"text",maxLength:"14",prefix:"$ ",suffix:" COP"},model:{value:e.certificateData.rate,callback:function(t){e.$set(e.certificateData,"rate",t)},expression:"certificateData.rate"}})],1),a("q-select",{staticClass:"ControlForm col",attrs:{filled:"",disable:e.gettingInfo,label:"Empresa",options:e.companies,"option-value":"id","option-label":"name","stack-label":"","lazy-rules":"",rules:[]},model:{value:e.certificateData.company,callback:function(t){e.$set(e.certificateData,"company",t)},expression:"certificateData.company"}})],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"ControlForm col q-mr-md",attrs:{filled:"",disable:e.gettingInfo,label:"Fecha","stack-label":"",readonly:"",rules:[function(e){return e&&e.length>0||"Por favor ingresa una fecha"}]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{mask:"DD/MM/YYYY",options:e.maxDateIsToday},on:{input:function(){return e.$refs.qDateProxy.hide()}},model:{value:e.certificateData.date,callback:function(t){e.$set(e.certificateData,"date",t)},expression:"certificateData.date"}})],1)],1)]},proxy:!0}]),model:{value:e.certificateData.date,callback:function(t){e.$set(e.certificateData,"date",t)},expression:"certificateData.date"}}),a("q-input",{staticClass:"ControlForm col",attrs:{filled:"",disable:e.gettingInfo,label:"Fecha vencimiento","stack-label":"",readonly:"",rules:[function(e){return e&&e.length>0||"Por favor ingresa una fecha"}]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{mask:"DD/MM/YYYY",options:e.minDateIsToday},on:{input:function(){return e.$refs.qDateProxy.hide()}},model:{value:e.certificateData.dateOut,callback:function(t){e.$set(e.certificateData,"dateOut",t)},expression:"certificateData.dateOut"}})],1)],1)]},proxy:!0}]),model:{value:e.certificateData.dateOut,callback:function(t){e.$set(e.certificateData,"dateOut",t)},expression:"certificateData.dateOut"}})],1),a("q-separator",{staticClass:"q-mb-sm"}),a("div",{attrs:{align:"center"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"negative",type:"reset",flat:"",label:"Cancelar",disable:e.loadingAlter}}),a("q-btn",{attrs:{color:"positive",type:"submit",flat:"",label:"Guardar",disable:e.gettingInfo,loading:e.loadingAlter}})],1)],1)],1)],1)],1)],1)},n=[],r=(a("456d"),a("8a81"),a("d25f"),a("9986"),a("8e6e"),a("c973")),s=a.n(r),c=a("9523"),o=a.n(c),l=(a("7514"),a("a34a")),u=a.n(l),f=a("bd4c"),p=a("716b"),d=a("333e"),m=a("e802"),b=a("b924"),h=a("e71c"),g=a("234a"),D=a("8a6e"),v=a("2fa3"),y=[{en:"id",es:"ID"},{en:"rate",es:"TARIFA"},{en:"date",es:"FECHA"},{en:"dateOut",es:"FECHA VENCIMIENTO"},{en:"company",es:"EMPRESA"}],x=["rate","date","dateOut","company"];function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){o()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var O=f["b"].formatDate,q=Date.now(),Y={name:"Certificates",components:{TableView:d["a"],InteractionOptions:b["a"],Money:p["Money"]},data:function(){return{alterCertificates:!1,reRenderTable:0,selected:[],visibleColumns:x,loadingDelete:!1,isCreate:null,gettingInfo:!1,loadingAlter:!1,loadingState:!0,today:q,certificateData:{rate:"",company:null,date:O(q,"DD/MM/YYYY"),dateOut:O(q,"DD/MM/YYYY")},withCompanies:!1}},mixins:[g["a"]],methods:{openCreateNew:function(){if(this.withCompanies)this.isCreate=!0,this.reset(),this.alterCertificates=!0;else{var e="No hay empresas disponibles";this.createNotification(w({message:e,timeout:8e3},h["s"]))}},openUpdate:function(){var e=this;return s()(u.a.mark((function t(){var a;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isCreate=!1,e.reset(),e.alterCertificates=!0,e.gettingInfo=!0,t.next=6,e.$store.dispatch("certificates/getForId",e.selected[0].id);case 6:a=t.sent,e.certificateData=a,e.gettingInfo=!1;case 9:case"end":return t.stop()}}),t)})))()},alterRow:function(){var e=this;return s()(u.a.mark((function t(){var a,i,n,r,s,c;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.loadingAlter=!0,!e.isCreate){t.next=22;break}return t.prev=2,t.next=5,D["a"].getApiFormat(e.certificateData);case 5:return a=t.sent,t.next=8,e.$store.dispatch("certificates/store",a);case 8:i="Registro exitoso",e.getData(),e.alterCertificates=!1,e.loadingAlter=!1,e.createNotification(w({message:i,timeout:3e3},h["q"])),t.next=20;break;case 15:t.prev=15,t.t0=t["catch"](2),n=Object(v["d"])(t.t0),e.createNotification(w({message:n,timeout:5e3},h["b"])),e.loadingAlter=!1;case 20:t.next=40;break;case 22:return t.prev=22,t.next=25,D["a"].getApiFormat(e.certificateData);case 25:return r=t.sent,t.next=28,e.$store.dispatch("certificates/update",r);case 28:s="Actualizacion exitosa",e.getData(),e.alterCertificates=!1,e.loadingAlter=!1,e.createNotification(w({message:s,timeout:3e3},h["q"])),t.next=40;break;case 35:t.prev=35,t.t1=t["catch"](22),c=Object(v["d"])(t.t1),e.createNotification(w({message:c,timeout:5e3},h["b"])),e.loadingAlter=!1;case 40:case"end":return t.stop()}}),t,null,[[2,15],[22,35]])})))()},organizerDataDelete:function(e){return e.reduce((function(e,t){return e.push({principal:t.rate,caption:t.company,side:t.date}),e}),[])},openDelete:function(){var e=this;this.$q.dialog({component:m["a"],parent:this,dataShow:this.organizerDataDelete(this.selected),dataDelete:this.selected,deleteFunction:this.deleteRows}).onOk((function(){e.selected=[],e.reRenderTable+=1})).onCancel((function(){})).onDismiss((function(){e.getData()}))},deleteRows:function(e){var t=this;return s()(u.a.mark((function a(){return u.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$store.dispatch("certificates/remove",e);case 2:case"end":return a.stop()}}),a)})))()},reset:function(){this.certificateData={rate:"",company:this.companies?this.companies[0]:null,date:O(q,"DD/MM/YYYY"),dateOut:O(q,"DD/MM/YYYY")}},maxDateIsToday:function(e){return e<=O(q,"YYYY/MM/DD")},minDateIsToday:function(e){return e>=O(q,"YYYY/MM/DD")},getData:function(){var e=this;return s()(u.a.mark((function t(){return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("certificates/get");case 2:return t.next=4,e.$store.dispatch("companies/get");case 4:e.withCompanies=e.companies.length>0,e.loadingState=!1;case 6:case"end":return t.stop()}}),t)})))()}},computed:{user:function(){return this.$q.localStorage.getItem(h["n"])},certificates:function(){return this.$store.getters["certificates/list"]},companies:function(){return this.$store.getters["companies/list"]},columns:function(){return Object(h["t"])(this.certificates,y,x)}},beforeRouteEnter:function(e,t,a){a((function(t){if(t.user){var i=Object(h["v"])(t.user.type),n=i.find((function(t){return t===e.path}));n||a(i[0]),a()}else a("/")}))},created:function(){var e=this;return s()(u.a.mark((function t(){return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getData();case 2:case"end":return t.stop()}}),t)})))()}},k=Y,I=(a("570b"),a("2877")),M=Object(I["a"])(k,i,n,!1,null,null,null);t["default"]=M.exports}}]);